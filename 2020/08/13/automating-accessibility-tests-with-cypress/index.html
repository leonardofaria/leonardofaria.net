<!doctype html><html prefix="og: http://ogp.me/ns#" lang=en-us><head itemscope itemtype=https://leonardofaria.github.io/leonardofaria.net><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:locale" content="en"><meta name=language content="en"><title itemprop=name>Automating accessibility tests with Cypress &#183; Leonardo Faria</title><meta property="og:title" content="Automating accessibility tests with Cypress &#183; Leonardo Faria"><meta name=twitter:title content="Automating accessibility tests with Cypress &#183; Leonardo Faria"><meta itemprop=name content="Automating accessibility tests with Cypress &#183; Leonardo Faria"><meta name=application-name content="Leonardo Faria"><meta property="og:site_name" content="Leonardo Faria"><base href=https://leonardofaria.github.io/leonardofaria.net/2020/08/13/automating-accessibility-tests-with-cypress/><link rel=canonical href=https://leonardofaria.github.io/leonardofaria.net/2020/08/13/automating-accessibility-tests-with-cypress/ itemprop=url><meta name=url content="https://leonardofaria.github.io/leonardofaria.net/2020/08/13/automating-accessibility-tests-with-cypress/"><meta name=twitter:url content="https://leonardofaria.github.io/leonardofaria.net/2020/08/13/automating-accessibility-tests-with-cypress/"><meta property="og:url" content="https://leonardofaria.github.io/leonardofaria.net/2020/08/13/automating-accessibility-tests-with-cypress/"><meta itemprop=image content="https://leonardofaria.github.io/images/og-images/2220.png"><meta property="og:image" content="https://leonardofaria.github.io/images/og-images/2220.png"><meta name=twitter:image content="https://leonardofaria.github.io/images/og-images/2220.png"><meta name=twitter:image:src content="https://leonardofaria.github.io/images/og-images/2220.png"><meta name=twitter:card content="summary_large_image"><meta property="og:type" content="article"><meta itemprop=description content="In my previous post, I covered how to add screenshot testing in Cypress to ensure components unintentionally change over time. Now, I will share how to automate"><meta property="og:description" content="In my previous post, I covered how to add screenshot testing in Cypress to ensure components unintentionally change over time. Now, I will share how to automate"><meta name=description content="In my previous post, I covered how to add screenshot testing in Cypress to ensure components unintentionally change over time. Now, I will share how to automate"><meta name=twitter:description content="In my previous post, I covered how to add screenshot testing in Cypress to ensure components unintentionally change over time. Now, I will share how to automate"><meta property="article:published_time" content="2020-08-13T00:00:00Z"><meta name=twitter:label1 value="Reading time"><meta name=twitter:data1 value="6 minutes"><meta name=twitter:label2 value=Published><meta name=twitter:data2 value="August 13, 2020"><meta property="article:tag" content="javascript"><meta property="og:updated_time" content="2020-08-13T00:00:00Z"><meta property="og:article:author" content="Leonardo Faria"><meta property="article:author" content="Leonardo Faria"><meta name=author content="Leonardo Faria"><meta name=generator content="Hugo 0.73.0"><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com/ crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel=stylesheet><link rel=stylesheet href=https://leonardofaria.github.io/leonardofaria.net/css/styles.min.0f1a07fa6013988f3640ab8076347106f984a80a42c9bd9b2009cfda32a8e9a3.css integrity="sha256-DxoH+mATmI82QKuAdjRxBvmEqApCyb2bIAnP2jKo6aM="><link href=/leonardofaria.net/index.xml rel=alternate type=application/rss+xml title="Leonardo Faria"><script src=https://cdnjs.cloudflare.com/ajax/libs/turbolinks/5.2.0/turbolinks.js></script><link rel=webmention href=https://webmention.io/leonardofaria.net/webmention><link rel=pingback href=https://webmention.io/leonardofaria.net/xmlrpc><script src=https://leonardofaria.github.io/leonardofaria.net/js/webmentions.min.08cc9bae8a99aae297e64b2c62dafb59df5b79edbd86de6b52528a752a4cd499.js type=text/javascript></script></head><body class="bg-gradient flex flex-col min-h-screen"><header id=header class="w-full m-0 fixed z-10 transition-all duration-300 ease-in-out border-t-4 border-gray-300 backdrop-filter-blur"><div id=header-container class="max-w-7xl mx-auto p-6 flex items-center flex-wrap lg:flex-no-wrap relative justify-between"><a href=https://leonardofaria.github.io/leonardofaria.net/ class="tracking-tighter leading-10 text-3xl font-semibold text-gray-600 flex flex-shrink-0">Leonardo Faria</a><div class="block lg:hidden mx-2"><button class="nav-button w-10 h-10 justify-center flex items-center opacity-75 hover:opacity-100 transition duration-300 ease-in-out"><svg class="fill-current h-4 w-4" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><title>Menu</title><path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"/></svg></button>
<button class="hidden nav-button w-10 h-10 justify-center flex items-center opacity-75 hover:opacity-100 transition duration-300 ease-in-out"><svg class="fill-current h-4 w-4" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><title>Close menu</title><polygon points="11 9 22 9 22 11 11 11 11 22 9 22 9 11 -2 11 -2 9 9 9 9 -2 11 -2" transform="rotate(45 10 10)"/></svg></button></div><div class="absolute right-8 top-16 lg:relative lg:right-0 lg:top-0 flex flex-col lg:flex-row items-center rounded-md bg-white shadow lg:bg-transparent lg:shadow-none"><nav id=nav-social-links class="p-4 lg:p-0 text-gray-600 hidden lg:block lg:order-last w-full lg:w-auto lg:ml-3"><ul class="flex justify-end"><li><a class="block p-2 opacity-75 hover:opacity-100 transition duration-300 ease-in-out" title=Twitter href=https://www.twitter.com/leozera rel=me><svg class="fill-current w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><title>Twitter</title><path d="M6.29 18.25c7.55.0 11.67-6.25 11.67-11.67v-.53c.8-.59 1.49-1.3 2.04-2.13-.75.33-1.54.55-2.36.65a4.12 4.12.0 001.8-2.27c-.8.48-1.68.81-2.6 1a4.1 4.1.0 00-7 3.74 11.65 11.65.0 01-8.45-4.3 4.1 4.1.0 001.27 5.49C2.01 8.2 1.37 8.03.8 7.7v.05a4.1 4.1.0 003.3 4.03 4.1 4.1.0 01-1.86.07 4.1 4.1.0 003.83 2.85A8.23 8.23.0 010 16.4a11.62 11.62.0 006.29 1.84"/></svg></a></li><li><a class="block p-2 opacity-75 hover:opacity-100 transition duration-300 ease-in-out" title=Github href=https://www.github.com/leonardofaria rel=me><svg class="fill-current w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><title>GitHub</title><path d="M10 0A10 10 0 006.84 19.49c.5.1.68-.22.68-.48l-.01-1.7c-2.78.6-3.37-1.34-3.37-1.34-.46-1.16-1.11-1.47-1.11-1.47-.9-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.9 1.52 2.34 1.08 2.91.83.1-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.94.0-1.1.39-1.99 1.03-2.69a3.6 3.6.0 01.1-2.64s.84-.27 2.75 1.02a9.58 9.58.0 015 0c1.91-1.3 2.75-1.02 2.75-1.02.55 1.37.2 2.4.1 2.64.64.7 1.03 1.6 1.03 2.69.0 3.84-2.34 4.68-4.57 4.93.36.31.68.92.68 1.85l-.01 2.75c0 .26.18.58.69.48A10 10 0 0010 0"/></svg></a></li><li><a class="block p-2 opacity-75 hover:opacity-100 transition duration-300 ease-in-out" title=Linkedin href=https://linkedin.com/in/leonardofariacoelho rel=me><svg class="fill-current w-5 h-5" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>LinkedIn</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853.0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601.0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144.0-2.063-.926-2.063-2.065.0-1.138.92-2.063 2.063-2.063 1.14.0 2.064.925 2.064 2.063.0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225.0H1.771C.792.0.0.774.0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2.0 22.222.0h.003z"/></svg></a></li><li><a class="block p-2 opacity-75 hover:opacity-100 transition duration-300 ease-in-out" title=Email href=mailto:leonardofaria@gmail.com><svg class="fill-current w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V4e2c0 26.5-21.5 48-48 48H48c-26.5.0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5.0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"/></svg></a></li><li><a class="block p-2 opacity-75 hover:opacity-100 transition duration-300 ease-in-out" title=Feed href=/feed><svg class="fill-current w-5 h-5" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>RSS</title><path d="M19.199 24C19.199 13.467 10.533 4.8.0 4.8V0c13.165.0 24 10.835 24 24h-4.801zM3.291 17.415c1.814.0 3.293 1.479 3.293 3.295.0 1.813-1.485 3.29-3.301 3.29C1.47 24 0 22.526.0 20.71s1.475-3.294 3.291-3.295zM15.909 24h-4.665c0-6.169-5.075-11.245-11.244-11.245V8.09c8.727.0 15.909 7.184 15.909 15.91z"/></svg></a></li></ul></nav><nav id=nav-menu class="p-4 lg:p-0 hidden lg:block w-full lg:w-auto text-gray-600"><ul class="w-full flex flex-col lg:flex-row justify-end items-end lg:items-center"><li class="flex my-2 lg:my-2 mx-1 lg:mx-2"><a title=Archives class="uppercase font-bold lg:py-2 lg:px-3 rounded text-sm opacity-75 hover:opacity-100 transition duration-300 ease-in-out" href=/leonardofaria.net/archives>Archives</a></li><li class="flex my-2 lg:my-2 mx-1 lg:mx-2"><a title=Portfolio class="uppercase font-bold lg:py-2 lg:px-3 rounded text-sm opacity-75 hover:opacity-100 transition duration-300 ease-in-out" href=/leonardofaria.net/portfolio>Portfolio</a></li><li class="flex my-2 lg:my-2 mx-1 lg:mx-2"><a title=Talks class="uppercase font-bold lg:py-2 lg:px-3 rounded text-sm opacity-75 hover:opacity-100 transition duration-300 ease-in-out" href=/leonardofaria.net/talks>Talks</a></li></ul></nav></div></div></header><main class="flex-1 mt-12 max-w-3xl mt-32 mx-auto text-gray-700 w-full"><div id=reading-progress-bar role=presentation class="fixed z-10 top-0 left-0 h-1 bg-gray-700"></div><article class=article><header class="text-center pt-10 pb-6"><small class="text-center text-sm"><time class=text-gray-500 datetime=2020-08-13T00:00:00+00:00>August 13, 2020</time>
<a href=https://leonardofaria.github.io/leonardofaria.net/tags/javascript/ class="inline-flex items-center px-4 py-1 rounded-full no-underline bg-orange-100 text-orange-800 hover:bg-orange-300 ml-4">javascript</a></small><h1 class="leading-9 text-center"><a href=https://leonardofaria.github.io/leonardofaria.net/2020/08/13/automating-accessibility-tests-with-cypress/ class="no-underline inline-block text-black relative"><div class=dots aria-hidden=true></div>Automating accessibility tests with Cypress</a></h1></header><div class=article__content><p>In my <a href=https://leonardofaria.net/2020/08/03/adding-screenshot-testing-with-cypress-in-your-project/>previous post</a>, I covered how to add screenshot testing in Cypress to ensure components unintentionally change over time. Now, I will share how to automate accessibility tests with Cypress.</p><h2 id=why-should-we-care-about-accessibility>Why should we care about accessibility?</h2><p>Short answer: because it is the right thing to do.</p><p>Long answer: an accessible web can help people with disabilities improve their lives. There are different kinds of disabilities, including auditory, cognitive, neurological, physical, speech and visual and our goal as product creators, engineers, designers is creating experiences that can include all people.</p><p>It is also important to mention that web accessibility also benefits people <em>without</em> disabilities, for example, someone changing abilities due to ageing or people with slow Internet connections or using devices with small screens. Last not least, disability can also be temporary, for example, someone with a broken arm can&rsquo;t type and use a mouse at the same time.</p><p>If you want to educate yourself about the topic, I can recommend the <a href=https://www.w3.org/WAI/>W3C Web Accessibility Initiative (W3C WAI)</a> and <a href=https://www.a11yproject.com/>The A11Y Project</a>.</p><h2 id=accessibility-testing-techniques>Accessibility testing techniques</h2><p>There are different ways to test if your website/app is accessible. The W3C WAI has a <a href=https://www.w3.org/WAI/ER/tools/>list of 140+ tools</a> to help you determine if your website/app meets accessibility guidelines. You can also add in your strategy:</p><ul><li>Real users testing: companies like <a href=https://www.makeitfable.com/>Fable</a> connect you and people with disabilities in research and user testing to meet your compliance goals.</li><li>Browser extensions: <a href=https://www.deque.com/axe/browser-extensions/>axe</a> is a recommended extension for Chrome, Firefox, Edge that help identify and resolve common accessibility issues.</li></ul><p>The <a href=https://github.com/dequelabs/axe-core>accessibility engine of axe is open-source</a> and it can be used in different ways, as this post will show.</p><h2 id=before-we-start>Before we start</h2><p>I created a <a href=https://cypress-accessibility-example.vercel.app/>sample website</a> to mimic a Component Library. It is a very simple website created with Tailwind CSS and hosted in Vercel and it documents 2 components: <a href=https://cypress-accessibility-example.vercel.app/badge.html>badge</a> and <a href=https://cypress-accessibility-example.vercel.app/button.html>button</a>.</p><p>You can check the <a href=https://github.com/leonardofaria/cypress-accessibility-example>source code</a> in GitHub. The website is static and it is inside the <code>public</code> folder. You can see the website locally by running <code>npm run serve</code> and checking in the browser <a href=http://localhost:8000>http://localhost:8000</a>.</p><p><img src=/wp-content/uploads/2020/08/cypress-sample-website.png alt="Sample website"></p><h2 id=adding-cypress-and-cypress-axe>Adding Cypress and cypress-axe</h2><p>Start by cloning the <a href=https://github.com/leonardofaria/cypress-example>example repository</a>. Next, create a new branch and install <a href=https://www.npmjs.com/package/cypress-axe>cypress-axe</a>, the package responsible for tieing the axe engine to Cypress.</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>git checkout -b add-cypress
npm install -D cypress cypress-axe
</code></pre></div><p>Next, create a <code>cypress/support/index.js</code> file containing:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#000;font-weight:700>import</span> <span style=color:#d14>&#39;cypress-axe&#39;</span>
</code></pre></div><p>This import will inject all the functions needed for tests.</p><h2 id=creating-the-accessibility-test>Creating the accessibility test</h2><p>Time to create the accessibility test. Here is the plan:</p><ol><li>Cypress will visit each page (badge and button) of the project.</li><li>Cypress will test each example in the page. The <a href=https://cypress-example.vercel.app/badge.html>Badge page</a> has 2 examples (Default and Pill), while the <a href=https://cypress-example.vercel.app/badge.html>Button page</a> has 3 examples (Default, Pill and Outline). All these examples are inside an <code>&lt;div></code> element with a <code>cypress-wrapper</code>. This class was added with the only intention to identify what needs to be tested.</li></ol><p>The first step is creating Cypress configuration file (<code>cypress.json</code>):</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json>{
  <span style=color:navy>&#34;baseUrl&#34;</span>: <span style=color:#d14>&#34;http://localhost:8000/&#34;</span>,
  <span style=color:navy>&#34;video&#34;</span>: <span style=color:#000;font-weight:700>false</span>
}
</code></pre></div><p>The <code>baseUrl</code> is the website running locally. As I mentioned before, <code>npm run serve</code> will serve the content of the <code>public</code> folder. The second option, <code>video</code> disables Cypress video recording, which won&rsquo;t be used in the project.</p><p>Time to create the test. In <code>cypress/integration/accessibility.spec.js</code>, add:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#000;font-weight:700>const</span> routes <span style=color:#000;font-weight:700>=</span> [<span style=color:#d14>&#39;badge.html&#39;</span>, <span style=color:#d14>&#39;button.html&#39;</span>];

describe(<span style=color:#d14>&#39;Component accessibility test&#39;</span>, () =&gt; {
  routes.forEach((route) =&gt; {
    <span style=color:#000;font-weight:700>const</span> componentName <span style=color:#000;font-weight:700>=</span> route.replace(<span style=color:#d14>&#39;.html&#39;</span>, <span style=color:#d14>&#39;&#39;</span>);
    <span style=color:#000;font-weight:700>const</span> testName <span style=color:#000;font-weight:700>=</span> <span style=color:#d14>`</span><span style=color:#d14>${</span>componentName<span style=color:#d14>}</span><span style=color:#d14> has no detectable accessibility violations on load`</span>;

    it(testName, () =&gt; {
      cy.visit(route);
      cy.injectAxe();
      
      cy.get(<span style=color:#d14>&#39;.cypress-wrapper&#39;</span>).each((element, index) =&gt; {
        cy.checkA11y(
          <span style=color:#d14>&#39;.cypress-wrapper&#39;</span>,
          {
            runOnly<span style=color:#000;font-weight:700>:</span> {
              type<span style=color:#000;font-weight:700>:</span> <span style=color:#d14>&#39;tag&#39;</span>,
              values<span style=color:#000;font-weight:700>:</span> [<span style=color:#d14>&#39;wcag2a&#39;</span>],
            },
          }
        );
      });
    });
  });
});
</code></pre></div><p>In the code above, I am creating dynamically tests based in the <code>routes</code> array. The test will check each <code>.cypress-wrapper</code> element against WCAG 2.0 Level A rules. There are different standards / purposes, as the table above shows:</p><table><thead><tr><th>Tag Name</th><th>Accessibility Standard / Purpose</th></tr></thead><tbody><tr><td><code>wcag2a</code></td><td>WCAG 2.0 Level A</td></tr><tr><td><code>wcag2aa</code></td><td>WCAG 2.0 Level AA</td></tr><tr><td><code>wcag21a</code></td><td>WCAG 2.1 Level A</td></tr><tr><td><code>wcag21aa</code></td><td>WCAG 2.1 Level AA</td></tr><tr><td><code>best-practice</code></td><td>Common accessibility best practices</td></tr><tr><td><code>wcag***</code></td><td>WCAG success criterion e.g. wcag111 maps to SC 1.1.1</td></tr><tr><td><code>ACT</code></td><td>W3C approved Accessibility Conformance Testing rules</td></tr><tr><td><code>section508</code></td><td>Old Section 508 rules</td></tr><tr><td><code>section508.*.*</code></td><td>Requirement in old Section 508</td></tr></tbody></table><p>You can find more information about it in the <a href=https://github.com/dequelabs/axe-core/blob/develop/doc/API.md#axe-core-tags>axe-core docs</a>.</p><p>Last, let&rsquo;s create inside the <code>package.json</code> the command to trigger the tests:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json>{
  <span style=color:navy>&#34;test&#34;</span>: <span style=color:#d14>&#34;cypress&#34;</span>
}  
</code></pre></div><p>From here, there are 2 options: run Cypress in headless mode with <code>npm run cypress run</code> or use the Cypress Test Runner with <code>npm run cypress open</code>.</p><h3 id=headless-option>Headless option</h3><p>Using <code>npm run test run</code>, the output should be similar to the next image:</p><p><img src=/wp-content/uploads/2020/08/cypress-accessibility-first-test.jpg alt="Output of first test"></p><p>The tests will pass since the components have no accessibility issues.</p><h3 id=test-runner-option>Test Runner option</h3><p>Using <code>npm run test open</code>, Cypress Test Runner will be opened and you can follow step by step the tests.</p><p><img src=/wp-content/uploads/2020/08/cypress-accessibility-test-runner.jpg alt="Cypress Test Runner screenshot"></p><p>Our first milestone is done, let&rsquo;s merge this branch to master. If you want to see the work done so far, jump in my <a href=https://github.com/leonardofaria/cypress-accessility-example/pull/1/files>Pull Request</a>.</p><h2 id=testing-in-real-life>Testing in real life</h2><p>Imagine we are updating the website and we want to identify the buttons with ids. The <code>id</code> property must be unique in the document, we can&rsquo;t have 2 elements with the same one, however, we forgot about that and 3 buttons have the same id.</p><p>Cypress will fail and the output will look something like this:</p><p><img src=/wp-content/uploads/2020/08/cypress-accessibility-failed-test.jpg alt="Output of failed test"></p><p>Let&rsquo;s improve the output of our tests by showing a table of found issues. First, let&rsquo;s create a new branch:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>git checkout -b improve-cypress-tests
</code></pre></div><p>Next, create the <code>cypress/plugins/index.js</code> file with the following content:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>module.exports <span style=color:#000;font-weight:700>=</span> (on, config) =&gt; {
  on(<span style=color:#d14>&#39;task&#39;</span>, {
    log(message) {
      console.log(message)
 
      <span style=color:#000;font-weight:700>return</span> <span style=color:#000;font-weight:700>null</span>
    },
    table(message) {
      console.table(message)
 
      <span style=color:#000;font-weight:700>return</span> <span style=color:#000;font-weight:700>null</span>
    }
  })
}
</code></pre></div><p>This will execute code in Node via the <code>task</code> plugin event of Cypress. Next, let&rsquo;s go back to the <code>accessibility.spec.js</code> file and add the following function in the top of the file:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#000;font-weight:700>const</span> terminalLog <span style=color:#000;font-weight:700>=</span> (violations) =&gt; {
  cy.task(
    <span style=color:#d14>&#39;log&#39;</span>,
    <span style=color:#d14>`</span><span style=color:#d14>${</span>violations.length<span style=color:#d14>}</span><span style=color:#d14> accessibility violation</span><span style=color:#d14>${</span>
      violations.length <span style=color:#000;font-weight:700>===</span> <span style=color:#099>1</span> <span style=color:#000;font-weight:700>?</span> <span style=color:#d14>&#39;&#39;</span> <span style=color:#000;font-weight:700>:</span> <span style=color:#d14>&#39;s&#39;</span>
    <span style=color:#d14>}</span><span style=color:#d14> </span><span style=color:#d14>${</span>violations.length <span style=color:#000;font-weight:700>===</span> <span style=color:#099>1</span> <span style=color:#000;font-weight:700>?</span> <span style=color:#d14>&#39;was&#39;</span> <span style=color:#000;font-weight:700>:</span> <span style=color:#d14>&#39;were&#39;</span><span style=color:#d14>}</span><span style=color:#d14> detected`</span>
  )
  <span style=color:#998;font-style:italic>// pluck specific keys to keep the table readable
</span><span style=color:#998;font-style:italic></span>  <span style=color:#000;font-weight:700>const</span> violationData <span style=color:#000;font-weight:700>=</span> violations.map(
    ({ id, impact, description, nodes }) =&gt; ({
      id,
      impact,
      description,
      nodes<span style=color:#000;font-weight:700>:</span> nodes.length
    })
  )
 
  cy.task(<span style=color:#d14>&#39;table&#39;</span>, violationData)
}
</code></pre></div><p>The <code>violations</code> array contains all information about the failing elements. You can tweak this code to include, for instance, the element source code in the test output.</p><p>Last, lets call the function inside the tests. Modify the <code>checkA11y</code> function to:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>cy.checkA11y(
  <span style=color:#d14>&#39;.cypress-wrapper&#39;</span>,
  {
    runOnly<span style=color:#000;font-weight:700>:</span> {
      type<span style=color:#000;font-weight:700>:</span> <span style=color:#d14>&#39;tag&#39;</span>,
      values<span style=color:#000;font-weight:700>:</span> [<span style=color:#d14>&#39;wcag2a&#39;</span>],
    },
  },
  terminalLog,
);
</code></pre></div><p>When you run the test again, you&rsquo;ll a table containing the issues reported by axe:</p><p><img src=/wp-content/uploads/2020/08/cypress-accessibility-failed-test-table.jpg alt="Output of failed test with a nice table"></p><p>If you have any questions, please check the <a href=https://github.com/leonardofaria/cypress-accessibility-example/pull/2/files>Pull request</a> in Github.</p><h2 id=next-steps>Next steps</h2><p>From here, you can continue your journey making products more accessible. As next steps, I would recommend:</p><ul><li>Adding these tests in your CI solution - I wrote about <a href=/2020/08/03/adding-screenshot-testing-with-cypress-in-your-project/#adding-ci>integrating Cypress inside Semaphore</a> before;</li><li>Finding the best way to customize the output of tests to improve troubleshooting issues;</li><li>Learning more about how axe works.</li></ul><p>I hope that you have learned that accessibility testing is not difficult and it doesn&rsquo;t require much to start. Automation powered by axe can definitely help us to create better user experiences to all people.</p></div><section class="my-5 pt-10 pb-5 border-t border-gray-400 flex items-center"><img alt="Avatar photo" class="border border-gray-400 p-1 w-10 h-10 rounded-full mr-3" src=/leonardofaria.net/images/avatar.jpg>
<span class=flex-grow>If you like my content, follow me on <a class="transition duration-300 ease-in-out hover:text-blue-600" href=https://twitter.com/leozera>Twitter</a> and <a class="transition duration-300 ease-in-out hover:text-blue-600" href=https://github.com/leonardofaria>GitHub</a></span>
<a href="http://twitter.com/share?url=https%3a%2f%2fleonardofaria.github.io%2fleonardofaria.net%2f2020%2f08%2f13%2fautomating-accessibility-tests-with-cypress%2f&text=Automating%20accessibility%20tests%20with%20Cypress&via=leozera" class="text-white text-xs font-bold rounded-md no-underline flex items-center px-3 py-2 bg-twitter hover:color-white hover:opacity-75 no-underline"><svg class="fill-current w-4 h-4 mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><title>Twitter</title><path d="M6.29 18.25c7.55.0 11.67-6.25 11.67-11.67v-.53c.8-.59 1.49-1.3 2.04-2.13-.75.33-1.54.55-2.36.65a4.12 4.12.0 001.8-2.27c-.8.48-1.68.81-2.6 1a4.1 4.1.0 00-7 3.74 11.65 11.65.0 01-8.45-4.3 4.1 4.1.0 001.27 5.49C2.01 8.2 1.37 8.03.8 7.7v.05a4.1 4.1.0 003.3 4.03 4.1 4.1.0 01-1.86.07 4.1 4.1.0 003.83 2.85A8.23 8.23.0 010 16.4a11.62 11.62.0 006.29 1.84"/></svg>Tweet</a></section><section class="my-5 py-5 relative"><h2>Interactions</h2><h3>Webmentions</h3><div id=summary class="flex items-center"><button id=button-likes-0cd89d500c949d270036c53afbdf8c16 class="flex items-center mr-6 p-3 bg-gray-100 hover:bg-white transition duration-300 ease-in-out rounded-md"><svg class="w-6 h-6 mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentcolor"><path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656.0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd"/></svg>
<span id=webmentions-total-likes class=mr-1></span></button>
<button id=button-interactions-0cd89d500c949d270036c53afbdf8c16 class="flex items-center mr-6 p-3 bg-gray-100 hover:bg-white transition duration-300 ease-in-out rounded-md"><svg class="w-6 h-6 mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentcolor"><path fill-rule="evenodd" d="M18 13V5a2 2 0 00-2-2H4A2 2 0 002 5v8a2 2 0 002 2h3l3 3 3-3h3a2 2 0 002-2zM5 7a1 1 0 011-1h8a1 1 0 110 2H6A1 1 0 015 7zm1 3a1 1 0 100 2h3a1 1 0 100-2H6z" clip-rule="evenodd"/></svg>
<span id=webmentions-total-interactions class=mr-1></span></button><div class=flex-grow><div id=webmentions-avatars class="flex -space-x-2 overflow-hidden"></div></div></div><template id=reply-template class=list-none><li class="flex mb-8 text-base"><a class="js-author flex-shrink-0" href><img class="js-avatar w-8 h-8 rounded-full mr-3" alt src></a><div><div><strong><a class="js-author-name no-underline" href></a></strong><small><a class="js-date js-source no-underline ml-2" href></a></small></div><div class=js-content></div></div></li></template><template id=like-template class=list-none><li class="flex mb-8 text-base"><a class="js-author flex-shrink-0" href><img class="js-avatar w-8 h-8 rounded-full mr-3" alt src></a>
<a class="js-source no-underline" href><span class="js-sentence js-author-name" href></span><small class="js-date ml-2" href></small></a></li></template><div id=webmentions-interactions-0cd89d500c949d270036c53afbdf8c16 class=hidden><h4>Replies & Shares</h4><ul id=replies></ul><ul id=shares></ul></div><div id=webmentions-likes-0cd89d500c949d270036c53afbdf8c16 class=hidden><h4>Likes</h4><ul id=likes></ul></div><script type=text/javascript>var webmentions=(permalink,aliases,productionBaseUrl)=>{fetchWebmentions(permalink,aliases,productionBaseUrl);document.querySelector('#button-interactions-0cd89d500c949d270036c53afbdf8c16').addEventListener('click',()=>{document.querySelector('#webmentions-interactions-0cd89d500c949d270036c53afbdf8c16').classList.toggle('hidden');});document.querySelector('#button-likes-0cd89d500c949d270036c53afbdf8c16').addEventListener('click',()=>{document.querySelector('#webmentions-likes-0cd89d500c949d270036c53afbdf8c16').classList.toggle('hidden');});};document.addEventListener('turbolinks:load',webmentions("https://leonardofaria.github.io/leonardofaria.net/2020/08/13/automating-accessibility-tests-with-cypress/",null,"https://leonardofaria.net"));</script><h3>Comments</h3><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"leonardofaria"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></article><aside class=flex><a class="w-full md:w-1/2 flex flex-col items-center py-7 px-3 no-underline rounded-md hover:bg-white transition duration-300 ease-in-out" href=/leonardofaria.net/2020/09/01/three-privacy-focused-open-source-google-analytics-alternatives/><span class="border border-gray-6 text-xs rounded-md mb-2 uppercase font-bold py-2 px-3">Read this next</span>
<span class=text-center>3 privacy-focused open-source Google Analytics alternatives for your next project</span></a>
<a class="w-full md:w-1/2 flex flex-col items-center py-7 px-3 no-underline rounded-md hover:bg-white transition duration-300 ease-in-out" href=/leonardofaria.net/2020/08/03/adding-screenshot-testing-with-cypress-in-your-project/><span class="border border-gray-6 text-xs rounded-md mb-2 uppercase font-bold py-2 px-3">You might enjoy</span>
<span class=text-center>Adding screenshot testing with Cypress in your project</span></a></aside></main><footer class="w-full max-w-7xl mx-auto text-center border-t border-gray-200 py-9 px-3 mt-9 pin-b text-sm text-gray-500">Made with <a href=https://gohugo.io class="underline transition duration-300 ease-in-out hover:text-blue-600">Hugo</a> and <a href=https://github.com/leonardofaria/bento class="underline transition duration-300 ease-in-out hover:text-blue-600">Bento theme</a>.</footer><script>var initMenu=()=>{var navButtons=document.querySelectorAll('.nav-button');var navMenu=document.querySelector('#nav-menu');var navSocialLinks=document.querySelector('#nav-social-links');for(var button of navButtons){button.addEventListener('click',()=>{console.log('click')
navMenu.classList.toggle("hidden");if(navSocialLinks){navSocialLinks.classList.toggle("hidden");}
for(var navButton of navButtons){navButton.classList.toggle("hidden");};});}}
document.addEventListener('turbolinks:load',initMenu());</script><script>var initHeader=()=>{let scrollPos=window.scrollY;var header=document.querySelector('#header');var headerContainer=document.querySelector("#header-container");var readingProgressBar=document.querySelector("#reading-progress-bar");let scrollTop=0;let scrollBottom=0;let scrollPercent=0;var addClassOnScroll=()=>{header.classList.add("shadow");header.classList.add("bg-white-90");}
var removeClassOnScroll=()=>{header.classList.remove("shadow");header.classList.remove("bg-white-90");}
window.onscroll=function(){scrollPos=window.scrollY;scrollTop=document.documentElement["scrollTop"]||document.body["scrollTop"];scrollBottom=(document.documentElement["scrollHeight"]||document.body["scrollHeight"])-document.documentElement.clientHeight;scrollPercent=scrollTop/scrollBottom*100;readingProgressBar.style.width=(scrollTop/scrollBottom*100)+'%';if(scrollPos>0){addClassOnScroll()}
else{removeClassOnScroll()}}}
document.addEventListener('turbolinks:load',initHeader());</script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-157386-6','auto');ga('send','pageview');}</script><script async defer data-website-id=ef25ee64-202b-4378-822f-22398533a59c src=https://umami.leonardofaria.net/umami.js></script></body></html>